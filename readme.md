# pro.fessional.mirana

## LightId

轻量级分布式主键，采用双缓冲机制，使用sequence高效生成64bit数字主键。
ID能保证严格单调递增，但不保证连续，其long型的64bit构成如下。

 * long = `1-bit:0固定`+ `8-bit:验证`+ `10-bit:区块`+`45-bit:序号`
 * `0固定`，保证ID为非负数。
 * `验证`，默认为0填充，使用时，用CRC8Long生成，可构造伪随机数。
 * `区块`，block(10bit=1023)，用来区分不同的主键生产中心。
 * `序号`，sequence(45bit=35184372088831)，`区块内`唯一递增序号。

因为有效位只有55bit，所以存在以下特点。

 * 生产中心，最多1024个。通常一个数据中心，有一个生产中心。
 * 若每秒消费5万ID，能连续22年，(2^45 -1)/(365x24x3600x50000)=22.3
 * sequence和时间无关，所以并发上限和使用年限，只根ID消费者能力有关。
 * sequence和进程无关，所以能以key-value形式，产生不同类别的ID。
 

系统提供默认的双缓冲实现，当1级缓冲低于某比例时，会异歩补充1级缓存。

## 常用命名

* Null 等效于null的默认值。
* None 等效于empty的默认值。
* Sugar 表示静态线程安全的工具类，可做kotlin语法糖
* Help 表示和业务关联的或有生命周期的辅助类
* Util 表示静态线程安全的工具类